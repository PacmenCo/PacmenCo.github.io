<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pet Database – Idle Adventure | Complete Pet & Companion List</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Complete Idle Adventure pet database: Browse all pets and companions with detailed stats, abilities, and unlock requirements in one searchable database.">
  <meta name="keywords" content="Idle Adventure pet database, pet list, companion database, pet stats, all pets, pet viewer">
  <meta name="author" content="PacmenCo">
  <meta name="theme-color" content="#0a0e1a">
  <link rel="canonical" href="https://pacmenco.github.io/pets-viewer.html">
  <meta property="og:type" content="article">
  <meta property="og:title" content="Idle Adventure Pet Database">
  <meta property="og:description" content="Complete searchable database of all pets and companions with stats and abilities.">
  <meta property="og:site_name" content="Idle Adventure Guide">
  <meta name="twitter:card" content="summary">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Shared Navigation Component -->
  <script src="nav.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg-dark: #0a0e1a; --bg-card: #1a1f35;
      --accent-purple: #7c3aed; --accent-orange: #f59e0b;
      --accent-cyan: #06b6d4; --accent-red: #ef4444; --accent-green: #10b981;
      --text-primary: #f3f4f6; --text-secondary: #9ca3af;
    }
    body { font-family: 'Space Grotesk', sans-serif; background: var(--bg-dark); color: var(--text-primary); line-height: 1.6; }
    .nav-bar { position: fixed; top: 0; width: 100%; background: rgba(10, 14, 26, 0.95); backdrop-filter: blur(10px); padding: 1rem 2rem; z-index: 1000; border-bottom: 1px solid rgba(124, 58, 237, 0.2); }
    .nav-content { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
    .nav-logo { font-family: 'Press Start 2P'; font-size: 1rem; color: var(--accent-orange); text-shadow: 0 0 10px rgba(245, 158, 11, 0.5); text-decoration: none; }
    .back-link { color: var(--accent-cyan); text-decoration: none; font-weight: 600; transition: color 0.3s; }
    .back-link:hover { color: var(--accent-orange); }
    .container { max-width: 1400px; margin: 0 auto; padding: 6rem 2rem 3rem; }
    .hero-section { text-align: center; margin-bottom: 3rem; }
    .page-title { font-size: clamp(2.5rem, 6vw, 4rem); background: linear-gradient(135deg, var(--accent-orange), var(--accent-cyan)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 1rem; }
    .page-subtitle { font-size: 1.25rem; color: var(--text-secondary); max-width: 700px; margin: 0 auto; }

    /* Hidden class */
    .hidden { display: none !important; }

    /* Filter Section */
    .filter-section { background: var(--bg-card); border-radius: 16px; padding: 1.5rem; margin-bottom: 2rem; border: 2px solid rgba(124, 58, 237, 0.2); }
    .filter-type-tabs { display: flex; gap: 0.5rem; margin-bottom: 1rem; border-bottom: 2px solid rgba(124, 58, 237, 0.3); padding-bottom: 0.5rem; }
    .filter-type-btn { background: transparent; border: none; color: var(--text-secondary); padding: 0.5rem 1rem; cursor: pointer; font-size: 0.95rem; transition: all 0.3s ease; border-bottom: 2px solid transparent; margin-bottom: -0.5rem; font-family: 'Space Grotesk', sans-serif; }
    .filter-type-btn.active { color: var(--accent-purple); border-bottom-color: var(--accent-purple); }
    .filter-type-btn:hover { color: var(--accent-cyan); }
    .filter-buttons-container { display: flex; gap: 0.75rem; flex-wrap: wrap; }
    .filter-btn { background: rgba(124, 58, 237, 0.2); border: 1px solid rgba(124, 58, 237, 0.4); color: var(--text-primary); padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-family: 'Space Grotesk', sans-serif; font-size: 0.9rem; }
    .filter-btn:hover { background: rgba(124, 58, 237, 0.3); border-color: var(--accent-cyan); }
    .filter-btn.active { background: var(--accent-purple); border-color: var(--accent-orange); }

    /* Pets Grid */
    .pets-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1rem; }

    /* Pet Card */
    .pet-card { background: var(--bg-card); border-radius: 12px; padding: 1.5rem; border: 2px solid rgba(124, 58, 237, 0.2); transition: all 0.3s; cursor: pointer; text-decoration: none; display: block; overflow: hidden; word-wrap: break-word; }
    .pet-card:hover { transform: translateY(-5px); border-color: var(--accent-cyan); box-shadow: 0 8px 30px rgba(6, 182, 212, 0.3); }
    .pet-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
    .compact-icon { font-size: 2.5rem; width: 64px; height: 64px; display: flex; align-items: center; justify-content: center; }
    .compact-icon img { width: 64px; height: 64px; object-fit: contain; border-radius: 8px; }
    .pet-info { flex: 1; }
    .pet-name { font-size: 1.25rem; color: var(--accent-orange); margin-bottom: 0.25rem; font-weight: 600; }
    .pet-id { font-size: 0.75rem; color: var(--text-secondary); }
    .pet-stat { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem; background: rgba(6, 182, 212, 0.1); border-radius: 8px; margin-top: 0.75rem; }
    .stat-type { color: var(--accent-cyan); font-size: 0.9rem; font-weight: 600; }
    .stat-value { color: var(--accent-orange); font-weight: 700; }
    .pet-acquisition { margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid rgba(124, 58, 237, 0.2); }
    .method { display: inline-block; padding: 0.25rem 0.75rem; background: rgba(124, 58, 237, 0.3); border-radius: 12px; font-size: 0.75rem; color: var(--text-primary); margin-bottom: 0.5rem; }
    .requirement { display: block; font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.5rem; }

    /* Detail View */
    .detail-view { max-width: 900px; margin: 0 auto; }
    .back-btn { display: inline-block; background: rgba(124, 58, 237, 0.2); border: 1px solid rgba(124, 58, 237, 0.4); color: var(--text-primary); padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s; text-decoration: none; margin-bottom: 2rem; font-family: 'Space Grotesk', sans-serif; }
    .back-btn:hover { background: rgba(124, 58, 237, 0.3); border-color: var(--accent-cyan); }
    .detail-card { background: var(--bg-card); border-radius: 16px; padding: 2.5rem; border: 2px solid rgba(124, 58, 237, 0.2); }
    .detail-header { display: flex; align-items: center; gap: 1.5rem; margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 2px solid rgba(124, 58, 237, 0.2); }
    .detail-icon { font-size: 4rem; width: 96px; height: 96px; display: flex; align-items: center; justify-content: center; }
    .detail-icon img { width: 96px; height: 96px; object-fit: contain; border-radius: 12px; }
    .detail-title-group { flex: 1; }
    .detail-name { font-size: 2.5rem; color: var(--accent-orange); margin-bottom: 0.5rem; }
    .detail-id { font-size: 1rem; color: var(--text-secondary); }
    .stats-section { margin-bottom: 2rem; }
    .stats-section h3 { font-size: 1.25rem; color: var(--accent-orange); margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 1px; }
    .stat-highlight { background: rgba(124, 58, 237, 0.2); border: 2px solid var(--accent-purple); border-radius: 12px; padding: 1.5rem; display: flex; justify-content: space-between; align-items: center; }
    .stat-name { font-size: 1.1rem; color: var(--accent-cyan); font-weight: 600; }
    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 1rem; }
    .stat-item { background: rgba(20, 24, 41, 0.6); border: 1px solid rgba(124, 58, 237, 0.3); border-radius: 8px; padding: 1rem; text-align: center; }
    .label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem; display: block; }
    .value { font-size: 1.5rem; font-weight: 700; color: var(--accent-cyan); }
    .acquisition-box { background: rgba(6, 182, 212, 0.1); border-left: 4px solid var(--accent-cyan); padding: 1.25rem; border-radius: 4px; }
    .method-badge { display: inline-block; padding: 0.5rem 1rem; background: rgba(124, 58, 237, 0.3); border-radius: 12px; font-size: 0.9rem; color: var(--text-primary); margin-bottom: 0.75rem; font-weight: 600; }
    .acquisition-box p { color: var(--text-secondary); line-height: 1.7; }
    .loading { text-align: center; padding: 4rem; color: var(--text-secondary); }

    @media (max-width: 768px) {
      .container { padding: 5rem 1rem 2rem; }
      .pets-grid { grid-template-columns: repeat(auto-fill, minmax(135px, 1fr)); gap: 0.5rem; }
      .pet-card { padding: 0.5rem; }
      .compact-icon { font-size: 1.5rem; width: 40px; height: 40px; }
      .compact-icon img { width: 40px; height: 40px; }
      .pet-name { font-size: 0.85rem; }
      .pet-id { font-size: 0.65rem; }
      .pet-stat { padding: 0.4rem; font-size: 0.7rem; }
      .stat-type { font-size: 0.75rem; }
      .method { font-size: 0.65rem; padding: 0.2rem 0.4rem; }
      .requirement { font-size: 0.7rem; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .filter-section { padding: 1rem; }
      .detail-card { padding: 1.5rem; }
      .detail-header { flex-direction: column; align-items: flex-start; }
      .filter-type-tabs { flex-wrap: wrap; }
    }
  </style>
</head>
<body>
  <!-- Navigation loaded from nav.js -->

  <div class="container">
    <!-- Grid View (default) -->
    <div id="gridView">
      <div class="hero-section">
        <h1 class="page-title">Pet Database</h1>
        <p class="page-subtitle">Discover all 93 companions and their unique bonuses to enhance your adventure</p>
      </div>

      <!-- Filter section with tabs and buttons -->
      <div class="filter-section" id="filterSection"></div>

      <!-- Pet cards grid -->
      <div class="pets-grid" id="petsContainer">
        <div class="loading">Loading pets...</div>
      </div>
    </div>

    <!-- Detail View (hidden by default) -->
    <div id="detailView" class="hidden detail-view"></div>
  </div>

  <script>
    let allPets = [];
    let currentFilterType = 'stat';
    let currentFilterValue = 'all';
    let selectedEquippedStats = []; // For multi-select in equipped stats mode

    // Embedded fallback data
    const embeddedPetsData = {"pets":[{"id":0,"name":"Pet stone","icon":"\ud83e\udea8","baseLevel":0,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"Armor":1.0},"acquisition":{"method":"Default","requirement":"Always available"}},{"id":1,"name":"Sunflower","icon":"\ud83c\udf3b","baseLevel":1,"permanentStat":{"type":"Mana","value":3.0},"bonuses":{"HP":20.0,"Mana":5.0},"acquisition":{"method":"Combat","requirement":"Defeat 100 Sunflowers to obtain this pet!"}},{"id":2,"name":"Lady bug","icon":"\ud83d\udc1e","baseLevel":3,"permanentStat":{"type":"HP","value":15.0},"bonuses":{"Armor":4.0},"acquisition":{"method":"Default","requirement":"Idle in the first zone of 'The Garden' for 20 minutes in a row!"}},{"id":3,"name":"Butterfly","icon":"\ud83e\udd8b","baseLevel":2,"permanentStat":{"type":"Evasion","value":0.5},"bonuses":{"SpeedPercent":2.0,"Evasion":2.0},"acquisition":{"method":"Default","requirement":"Use a net maybe"}},{"id":4,"name":"Snake","icon":"\ud83d\udc0d","baseLevel":4,"permanentStat":{"type":"Accuracy","value":0.5},"bonuses":{"DamagePercent":3.0,"Accuracy":2.0},"acquisition":{"method":"Combat","requirement":"Defeat 250 Snakes"}},{"id":5,"name":"Small tree","icon":"\ud83c\udf33","baseLevel":3,"permanentStat":{"type":"Armor","value":2.0},"bonuses":{"ArmorPercent":5.0},"acquisition":{"method":"Default","requirement":"Spare some trees and save the world!"}},{"id":6,"name":"Shroom","icon":"\ud83c\udf44","baseLevel":6,"permanentStat":{"type":"LootChance","value":1.0},"bonuses":{"HPregen":0.1,"XpModifier":2.0},"acquisition":{"method":"Default","requirement":"Open wounds!"}},{"id":7,"name":"Ant","icon":"\ud83d\udc1c","baseLevel":11,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"DamagePercent":1.0,"BossDamage":5.0},"acquisition":{"method":"Default","requirement":"Defeat the ant on 'Normal Difficulty'"}},{"id":8,"name":"Bird","icon":"\ud83e\udd86","baseLevel":10,"permanentStat":{"type":"CritChance","value":0.5},"bonuses":{"CriticalChance":2.0},"acquisition":{"method":"Default","requirement":"Ask your dad how to catch a bird.."}},{"id":9,"name":"Mouse","icon":"\ud83d\udc2d","baseLevel":9,"permanentStat":{"type":"SpeedPercent","value":1.0},"bonuses":{"SpeedPercent":2.0,"Accuracy":2.0},"acquisition":{"method":"Combat","requirement":"Defeat 500 mice!"}},{"id":10,"name":"Frog","icon":"\ud83d\udc38","baseLevel":14,"permanentStat":{"type":"HPregenPercent","value":1.0},"bonuses":{"HPregen":0.15,"HPregenPercent":5.0},"acquisition":{"method":"Default","requirement":"Bark the frogs away!"}},{"id":11,"name":"Flamingo","icon":"\ud83e\udda9","baseLevel":12,"permanentStat":{"type":"LootChance","value":1.0},"bonuses":{"LootChance":6.0},"acquisition":{"method":"Default","requirement":"Idle in the second zone of 'The Pond' for 30 minutes in a row!"}},{"id":12,"name":"Toad","icon":"\ud83d\udc38","baseLevel":17,"permanentStat":{"type":"HPregen","value":0.3},"bonuses":{"HPPercent":5.0,"HPregen":0.15,"HPregenPercent":4.0},"acquisition":{"method":"Default","requirement":"Defeat 'Stomper' on 'Normal Difficulty'"}},{"id":13,"name":"Squirrel","icon":"\ud83d\udc3f\ufe0f","baseLevel":17,"permanentStat":{"type":"LootChance","value":1.0},"bonuses":{"SpeedPercent":5.0},"acquisition":{"method":"Special","requirement":"Get 30 attack speed!"}},{"id":14,"name":"Fox","icon":"\ud83e\udd8a","baseLevel":20,"permanentStat":{"type":"Mana","value":3.0},"bonuses":{"ManaRegen":0.15,"Accuracy":2.0},"acquisition":{"method":"Special","requirement":"Get more blue!"}},{"id":15,"name":"Sad Existence","icon":"\ud83d\udc7b","baseLevel":17,"permanentStat":{"type":"Resistance","value":0.5},"bonuses":{"DamagePercent":1.0,"Resistance":2.5},"acquisition":{"method":"Combat","requirement":"Defeat 750 Sad Existences"}},{"id":16,"name":"Rabbit","icon":"\ud83d\udc30","baseLevel":19,"permanentStat":{"type":"SpeedPercent","value":1.0},"bonuses":{"CriticalDamage":10.0,"SpawnRate":10.0},"acquisition":{"method":"Default","requirement":"When hard gets harder than hardest!"}},{"id":17,"name":"Red Hood","icon":"\ud83d\udc67","baseLevel":22,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"CriticalChance":1.5,"BossDamage":7.5},"acquisition":{"method":"Default","requirement":"Defeat the 'Big Bad Wolf' before he summons 'Little Red Riding Hood'"}},{"id":18,"name":"Wolf","icon":"\ud83d\udc3a","baseLevel":23,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"ArmorPercent":2.0,"BossDamage":8.0},"acquisition":{"method":"Default","requirement":"Defeat the Wolf on 'Normal Difficulty'"}},{"id":19,"name":"Small stone","icon":"\ud83e\udea8","baseLevel":23,"permanentStat":{"type":"Armor","value":2.0},"bonuses":{"Armor":10.0},"acquisition":{"method":"Default","requirement":"Idle in the first zone of 'The Quarry' for 40 mins in a row!"}},{"id":20,"name":"Sleeping stone","icon":"\ud83d\udca4","baseLevel":24,"permanentStat":{"type":"ManaRegen","value":0.1},"bonuses":{"ManaRegen":0.1,"ArmorPercent":5.0},"acquisition":{"method":"Default","requirement":"Idle in the Home area for 15 minutes in a row"}},{"id":21,"name":"Bumblebee","icon":"\ud83d\udc1d","baseLevel":26,"permanentStat":{"type":"CritDamage","value":3.0},"bonuses":{"SpeedPercent":2.0},"acquisition":{"method":"Default","requirement":"Use the net"}},{"id":22,"name":"Happy stone","icon":"\ud83d\ude0a","baseLevel":27,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"Armor":5.0,"ArmorPercent":3.0,"Resistance":1.0},"acquisition":{"method":"Combat","requirement":"Defeat 1.000 Happy Stones"}},{"id":23,"name":"King stone","icon":"\ud83d\udc51","baseLevel":32,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"Mana":5.0,"ArmorPercent":2.0,"Resistance":2.5},"acquisition":{"method":"Default","requirement":"Defeat 'Freddie' on 'Normal Difficulty'"}},{"id":24,"name":"Small Slime","icon":"\ud83d\udfe2","baseLevel":31,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"Mana":5.0,"ManaRegen":0.1},"acquisition":{"method":"Default","requirement":"Always available"}},{"id":25,"name":"Turtle","icon":"\ud83d\udc22","baseLevel":32,"permanentStat":{"type":"Resistance","value":0.5},"bonuses":{"SpeedPercent":-25.0,"ArmorPercent":13.0,"SpawnRate":-50.0},"acquisition":{"method":"Default","requirement":"Defeat a Tortoise with a single hit on 'Normal Difficulty'"}},{"id":26,"name":"Rat","icon":"\ud83d\udc00","baseLevel":35,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"HPPercent":-15.0,"CriticalChance":1.0,"CriticalDamage":10.0},"acquisition":{"method":"Default","requirement":"Idle in the second zone of 'The Swamps' for 30 minutes in a row!"}},{"id":27,"name":"Cobra","icon":"\ud83d\udc0d","baseLevel":37,"permanentStat":{"type":"DamagePercent","value":1.0},"bonuses":{"OpenWoundChance":2.0},"acquisition":{"method":"Default","requirement":"Confuse someone who is hiding"}},{"id":28,"name":"Caiman","icon":"\ud83d\udc0a","baseLevel":38,"permanentStat":{"type":"CritDamage","value":3.0},"bonuses":{"DamagePercent":4.0,"Armor":10.0},"acquisition":{"method":"Combat","requirement":"Defeat 2.000 Caimans"}},{"id":29,"name":"Mordots","icon":"\ud83e\udd8e","baseLevel":41,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"Mana":-50.0,"XpModifier":5.0,"Reflect":5.0},"acquisition":{"method":"Default","requirement":"Let Mordots poison you 100 times during a single encounter!"}},{"id":30,"name":"Tadpole","icon":"\ud83d\udc38","baseLevel":5,"permanentStat":{"type":"CritChance","value":0.5},"bonuses":{"Mana":10.0,"LootChance":2.0,"XpModifier":1.0},"acquisition":{"method":"Fishing","requirement":"Get 10 perfect throws in fishing in a row!"}},{"id":31,"name":"Neon Fish","icon":"\ud83d\udc20","baseLevel":10,"permanentStat":{"type":"LootChance","value":1.0},"bonuses":{"HPPercent":-25.0,"DamagePercent":1.0,"LootChance":7.5},"acquisition":{"method":"Fishing","requirement":"Reach level 5 fishing skill"}},{"id":32,"name":"Common Roach","icon":"\ud83d\udc1f","baseLevel":15,"permanentStat":{"type":"Accuracy","value":0.5},"bonuses":{"Damage":2.0,"Accuracy":2.0},"acquisition":{"method":"Fishing","requirement":"Reach level 10 fishing skill"}},{"id":33,"name":"Perch","icon":"\ud83d\udc1f","baseLevel":20,"permanentStat":{"type":"Evasion","value":0.5},"bonuses":{"HP":75.0,"Evasion":2.0},"acquisition":{"method":"Fishing","requirement":"Accumulate 5.000 grams of fish"}},{"id":34,"name":"Tigerbarbe","icon":"\ud83d\udc1f","baseLevel":25,"permanentStat":{"type":"SpeedPercent","value":1.0},"bonuses":{"SpeedPercent":7.5},"acquisition":{"method":"Fishing","requirement":"Get a combo of 100 in fishing"}},{"id":35,"name":"Stickleback","icon":"\ud83d\udc1f","baseLevel":30,"permanentStat":{"type":"Reflect","value":2.0},"bonuses":{"Reflect":10.0},"acquisition":{"method":"Fishing","requirement":"Get a combo of 250 in fishing"}},{"id":36,"name":"Contrast Flower","icon":"\ud83c\udf38","baseLevel":15,"permanentStat":{"type":"LootChance","value":1.0},"bonuses":{"HP":75.0,"Mana":5.0,"LootChance":5.0},"acquisition":{"method":"Fishing","requirement":"Complete the neverending quest 50 times"}},{"id":37,"name":"Burning Treestump","icon":"\ud83d\udd25","baseLevel":40,"permanentStat":{"type":"DamagePercent","value":1.0},"bonuses":{},"acquisition":{"method":"Special","requirement":"Complete the neverending quest 150 times"}},{"id":38,"name":"Quilty Kitty","icon":"\ud83d\udc31","baseLevel":56,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"XpModifier":3.0,"CriticalChance":2.0,"Reflect":10.0},"acquisition":{"method":"Special","requirement":"Complete the neverending quest 300 times"}},{"id":39,"name":"Rogue","icon":"\ud83d\udde1\ufe0f","baseLevel":41,"permanentStat":{"type":"Damage","value":0.5},"bonuses":{"DamagePercent":1.0,"SpeedPercent":2.0,"Resistance":1.0},"acquisition":{"method":"Special","requirement":"Reach level 200!"}},{"id":40,"name":"Scout","icon":"\ud83c\udff9","baseLevel":42,"permanentStat":{"type":"HPregenPercent","value":1.0},"bonuses":{},"acquisition":{"method":"Combat","requirement":"Defeat 2.500 Scouts!"}},{"id":41,"name":"Nunchaku Warrior","icon":"\ud83e\udd4b","baseLevel":41,"permanentStat":{"type":"HP","value":15.0},"bonuses":{"HP":130.0},"acquisition":{"method":"Special","requirement":"Reach Rank 50!"}},{"id":42,"name":"Spearman","icon":"\ud83d\udd31","baseLevel":43,"permanentStat":{"type":"SpeedPercent","value":1.0},"bonuses":{"Damage":3.0},"acquisition":{"method":"Combat","requirement":"Defeat 5.000 Spearmen!"}},{"id":43,"name":"Swordsman","icon":"\u2694\ufe0f","baseLevel":45,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"BossDamage":8.0},"acquisition":{"method":"Default","requirement":"No items with ilvl > 30"}},{"id":44,"name":"Flailer","icon":"\ud83d\udd28","baseLevel":44,"permanentStat":{"type":"HPPercent","value":1.5},"bonuses":{"HP":50.0,"Accuracy":-5.0},"acquisition":{"method":"Default","requirement":"Idle in the second zone of the Shieldhead Area for 35 minutes in a row!"}},{"id":45,"name":"Evasive Lancer","icon":"\ud83d\udee1\ufe0f","baseLevel":48,"permanentStat":{"type":"Evasion","value":0.5},"bonuses":{"Armor":5.0,"Evasion":4.0},"acquisition":{"method":"Combat","requirement":"Defeat 7.500 Evasive Lancers!"}},{"id":46,"name":"Mad Flailer","icon":"\ud83d\udd28","baseLevel":47,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{},"acquisition":{"method":"Default","requirement":"Idle in the third zone of the Shieldhead Area for 45 minutes in a row!"}},{"id":47,"name":"Wild Warrior","icon":"\u2694\ufe0f","baseLevel":48,"permanentStat":{"type":"LootChance","value":1.0},"bonuses":{"ArmorPercent":4.0,"BossDamage":5.0},"acquisition":{"method":"Default","requirement":"1 item only"}},{"id":48,"name":"Delirious Berserker","icon":"\ud83d\ude21","baseLevel":50,"permanentStat":{"type":"DamagePercent","value":1.0},"bonuses":{"DamagePercent":2.0},"acquisition":{"method":"Special","requirement":"Get 250 attack!"}},{"id":49,"name":"Blades Master","icon":"\u2694\ufe0f","baseLevel":50,"permanentStat":{"type":"CritDamage","value":3.0},"bonuses":{"Armor":2.0,"CriticalDamage":15.0},"acquisition":{"method":"Default","requirement":"Defeat a Blades Master without attacking!"}},{"id":50,"name":"Master Lancer","icon":"\ud83d\udd31","baseLevel":50,"permanentStat":{"type":"CritChance","value":0.5},"bonuses":{"ArmorPercent":4.0,"Evasion":3.0},"acquisition":{"method":"Combat","requirement":"Defeat 10.000 Master Lancer!"}},{"id":51,"name":"Shieldhead Chieftain","icon":"\ud83d\udee1\ufe0f","baseLevel":53,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"HPPercent":2.0,"Armor":5.0,"BossDamage":10.0},"acquisition":{"method":"Default","requirement":"Defeat the Shieldhead Chieftain on Hard Difficulty!"}},{"id":52,"name":"Ominous Cat","icon":"\ud83d\udc31","baseLevel":51,"permanentStat":{"type":"Mana","value":3.0},"bonuses":{"ManaRegen":0.1,"LootChance":3.0,"SpawnRate":10.0},"acquisition":{"method":"Special","requirement":"Really hard to become this blue!"}},{"id":53,"name":"Tzu Bat","icon":"\ud83e\udd87","baseLevel":51,"permanentStat":{"type":"Accuracy","value":0.5},"bonuses":{"OpenWoundChance":1.0},"acquisition":{"method":"Default","requirement":"If this was Pokemon, you would do this at least 10 times in a row!"}},{"id":54,"name":"Spectre","icon":"\ud83d\udc7b","baseLevel":52,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"ArmorPercent":5.0,"Evasion":2.0},"acquisition":{"method":"Combat","requirement":"Defeat 12.500 Spectres!"}},{"id":55,"name":"Zombieless Hand","icon":"\u270b","baseLevel":53,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"HPPercent":6.0,"XpModifier":1.0,"Accuracy":4.0},"acquisition":{"method":"Default","requirement":"Dogde a Zombieless Hand's' attack 10 times in a row!"}},{"id":56,"name":"Handless Zombie","icon":"\ud83e\udddf","baseLevel":54,"permanentStat":{"type":"HPPercent","value":1.5},"bonuses":{"HPregenPercent":5.0},"acquisition":{"method":"Combat","requirement":"Defeat 15.000 Handless Zombies!"}},{"id":57,"name":"Graveyard Raven","icon":"\ud83e\udd85","baseLevel":53,"permanentStat":{"type":"Evasion","value":0.5},"bonuses":{"SpeedPercent":2.0,"Evasion":3.0,"Accuracy":1.0},"acquisition":{"method":"Default","requirement":"Miss a Graveyard Raven 10 times in a row!"}},{"id":58,"name":"Anitemare","icon":"\ud83e\udd84","baseLevel":57,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"HP":80.0,"DamagePercent":2.0,"Resistance":3.0},"acquisition":{"method":"Default","requirement":"Defeat Anitemare on Hard Difficulty!"}},{"id":59,"name":"Crap","icon":"\ud83e\udd80","baseLevel":10,"permanentStat":{"type":"HP","value":15.0},"bonuses":{"HP":25.0,"Mana":5.0},"acquisition":{"method":"Special","requirement":"Reach a Highscore of 1500 in Space Invaders!"}},{"id":60,"name":"Invader","icon":"\ud83d\udc7e","baseLevel":17,"permanentStat":{"type":"HPregenPercent","value":1.0},"bonuses":{"HP":20.0,"DamagePercent":2.0,"Reflect":5.0},"acquisition":{"method":"Special","requirement":"Reach a Highscore of 4000 in Space Invaders!"}},{"id":61,"name":"Cool Invader","icon":"\ud83d\udc7e","baseLevel":25,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"HPPercent":3.0,"Evasion":2.0,"Accuracy":2.0},"acquisition":{"method":"Default","requirement":"Destroy 10 UFOs during a single game!"}},{"id":62,"name":"Zomguardian Doll","icon":"\ud83e\udddf","baseLevel":56,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"ArmorPercent":2.5,"Resistance":2.0,"OpenWoundChance":1.5},"acquisition":{"method":"Default","requirement":"Why do it all again?"}},{"id":63,"name":"Egg","icon":"\ud83e\udd5a","baseLevel":5,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"Armor":3.0,"Resistance":2.0},"acquisition":{"method":"Special","requirement":"Reach a Highscore of 100 Crossy Cube!"}},{"id":64,"name":"Chick","icon":"\ud83d\udc23","baseLevel":11,"permanentStat":{"type":"HPPercent","value":1.0},"bonuses":{"SpawnRate":10.0},"acquisition":{"method":"Special","requirement":"Reach a Highscore of 200 in Crossy Cube!"}},{"id":65,"name":"Chicken","icon":"\ud83d\udc14","baseLevel":25,"permanentStat":{"type":"HPregenPercent","value":1.0},"bonuses":{"Mana":3.0,"Evasion":3.0},"acquisition":{"method":"Default","requirement":"Find the Chicken!"}},{"id":66,"name":"Moosans","icon":"\ud83e\udd8c","baseLevel":40,"permanentStat":{"type":"HPregen","value":0.8},"bonuses":{"HP":35.0,"XpModifier":5.0},"acquisition":{"method":"Default","requirement":"Destroy a magical plant, and infuriate Moosans at least 5 times!"}},{"id":67,"name":"Little Shield Hood","icon":"\ud83d\udee1\ufe0f","baseLevel":49,"permanentStat":{"type":"DamagePercent","value":1.0},"bonuses":{"Evasion":5.0,"SpawnRate":12.0},"acquisition":{"method":"Default","requirement":"Defeat the 'Big Bad Wolf' on hard difficulty before he summons 'Little Red Riding Hood'!"}},{"id":68,"name":"Skeleton Doll","icon":"\ud83d\udc80","baseLevel":57,"permanentStat":{"type":"HPregenPercent","value":1.0},"bonuses":{"DamagePercent":3.0,"Resistance":2.0},"acquisition":{"method":"Combat","requirement":"Defeat 500 Skeleton Dolls"}},{"id":69,"name":"Zombie Doll","icon":"\ud83e\udddf","baseLevel":57,"permanentStat":{"type":"HP","value":20.0},"bonuses":{"HP":80.0,"HPregenPercent":3.0},"acquisition":{"method":"Combat","requirement":"Defeat 150 Zombie Dolls"}},{"id":70,"name":"Stygian Doll","icon":"\ud83d\udc7f","baseLevel":58,"permanentStat":{"type":"DamagePercent","value":1.0},"bonuses":{"DamagePercent":4.0,"Reflect":5.0},"acquisition":{"method":"Default","requirement":"1-5% hp left..."}},{"id":71,"name":"Skull","icon":"\ud83d\udc80","baseLevel":58,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"Damage":3.0,"Evasion":2.0,"Accuracy":2.0},"acquisition":{"method":"Combat","requirement":"Defeat a lot of Skulls"}},{"id":72,"name":"Burning Skull","icon":"\ud83d\udd25","baseLevel":58,"permanentStat":{"type":"Reflect","value":2.0},"bonuses":{"DamagePercent":2.0,"LootChance":2.0,"Reflect":12.0},"acquisition":{"method":"Default","requirement":"Survive the heat for 3 mins!"}},{"id":73,"name":"Dwarven Skeleton","icon":"\ud83d\udc80","baseLevel":58,"permanentStat":{"type":"HP","value":30.0},"bonuses":{"HPPercent":2.5,"DamagePercent":2.0,"Resistance":1.0},"acquisition":{"method":"Default","requirement":"Green bones??"}},{"id":74,"name":"Skeleton","icon":"\ud83d\udc80","baseLevel":58,"permanentStat":{"type":"Accuracy","value":0.5},"bonuses":{"LootChance":4.0,"ArmorPercent":1.5,"BossDamage":5.0},"acquisition":{"method":"Default","requirement":"One Shot!"}},{"id":75,"name":"Swarm","icon":"\ud83d\udc1d","baseLevel":58,"permanentStat":{"type":"Evasion","value":0.5},"bonuses":{"Mana":8.0,"LootChance":5.0,"Evasion":6.0},"acquisition":{"method":"Default","requirement":"A swarm of nasty bugs"}},{"id":76,"name":"Statue","icon":"\ud83d\uddff","baseLevel":58,"permanentStat":{"type":"HP","value":30.0},"bonuses":{"HP":50.0,"XpModifier":2.0,"Armor":10.0},"acquisition":{"method":"Default","requirement":"2442, exactly!"}},{"id":77,"name":"Young Abomination","icon":"\ud83d\udc7e","baseLevel":59,"permanentStat":{"type":"HP","value":30.0},"bonuses":{"HP":100.0,"HPPercent":4.0},"acquisition":{"method":"Collection","requirement":"Obtain 50 pets!"}},{"id":78,"name":"Obstructive Obstacle","icon":"\ud83e\uddf1","baseLevel":59,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"ArmorPercent":7.0,"CriticalDamage":4.0},"acquisition":{"method":"Default","requirement":"Validate the Obstructive Obstacle."}},{"id":79,"name":"Cursed Skull","icon":"\ud83d\udc80","baseLevel":59,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"Damage":2.0,"CriticalChance":2.0,"CriticalDamage":15.0},"acquisition":{"method":"Collection","requirement":"Obtain 75 pets!"}},{"id":80,"name":"Skeleton Rogue","icon":"\ud83d\udc80","baseLevel":59,"permanentStat":{"type":"HPPercent","value":1.0},"bonuses":{"ArmorPercent":9.0},"acquisition":{"method":"Crypt","requirement":"Reach 500 score in Crypt"}},{"id":81,"name":"Arachnid","icon":"\ud83d\udd77\ufe0f","baseLevel":59,"permanentStat":{"type":"LootChance","value":1.0},"bonuses":{"Mana":5.0,"Resistance":1.0,"OpenWoundChance":2.0},"acquisition":{"method":"Crypt","requirement":"Reach 1500 score in Crypt"}},{"id":82,"name":"Skeleton Magi","icon":"\ud83e\uddd9","baseLevel":59,"permanentStat":{"type":"BossDamage","value":1.5},"bonuses":{"Armor":5.0,"CriticalDamage":6.0,"BossDamage":7.0},"acquisition":{"method":"Crypt","requirement":"Reach 3000 score in Crypt"}},{"id":83,"name":"Emerald Golem","icon":"\ud83d\udc8e","baseLevel":60,"permanentStat":{"type":"XpModifier","value":2.0},"bonuses":{"Mana":3.0,"Armor":7.0,"OpenWoundChance":2.5},"acquisition":{"method":"Crypt","requirement":"Reach 5000 score in Crypt"}},{"id":84,"name":"Ruby Golem","icon":"\ud83d\udc8e","baseLevel":60,"permanentStat":{"type":"Accuracy","value":0.5},"bonuses":{"XpModifier":2.0,"Armor":7.0,"Reflect":8.0},"acquisition":{"method":"Crypt","requirement":"Reach 7500 score in Crypt"}},{"id":85,"name":"Sapphire Golem","icon":"\ud83d\udc8e","baseLevel":60,"permanentStat":{"type":"DamagePercent","value":1.0},"bonuses":{"Mana":13.0,"ManaRegen":0.05,"Armor":7.0},"acquisition":{"method":"Crypt","requirement":"Reach 10000 score in Crypt"}},{"id":86,"name":"Bully Ant","icon":"\ud83d\udc1c","baseLevel":23,"permanentStat":{"type":"ArmorPercent","value":1.0},"bonuses":{"Accuracy":1.0,"CriticalChance":1.0,"BossDamage":4.0},"acquisition":{"method":"Cosy Cave","requirement":"Reach 2500 score in Cosy Cave"}},{"id":87,"name":"Red Frog","icon":"\ud83d\udc38","baseLevel":29,"permanentStat":{"type":"HPregenPercent","value":1.0},"bonuses":{"HPregen":0.12,"HPregenPercent":5.0,"LootChance":1.0},"acquisition":{"method":"Cosy Cave","requirement":"Reach 7500 score in Cosy Cave"}},{"id":88,"name":"Blackmailer","icon":"\ud83d\udc64","baseLevel":33,"permanentStat":{"type":"HP","value":30.0},"bonuses":{},"acquisition":{"method":"Cosy Cave","requirement":"Reach 15000 score in Cosy Cave"}},{"id":89,"name":"Vampire Stone","icon":"\ud83e\udddb","baseLevel":40,"permanentStat":{"type":"Armor","value":3.0},"bonuses":{"HP":85.0,"Armor":9.0,"Resistance":2.0},"acquisition":{"method":"Cosy Cave","requirement":"Reach 25000 score in Cosy Cave"}},{"id":90,"name":"Ratigan","icon":"\ud83d\udc00","baseLevel":43,"permanentStat":{"type":"HPregen","value":0.4},"bonuses":{"SpeedPercent":5.0,"XpModifier":1.5,"OpenWoundChance":1.0},"acquisition":{"method":"Cosy Cave","requirement":"Reach 35000 score in Cosy Cave"}},{"id":91,"name":"Crying Ghost","icon":"\ud83d\udc7b","baseLevel":45,"permanentStat":{"type":"Evasion","value":0.5},"bonuses":{"HP":35.0,"Resistance":1.8,"Evasion":5.0},"acquisition":{"method":"Cosy Cave","requirement":"Reach 40000 score in Cosy Cave"}},{"id":92,"name":"MuscleBob","icon":"\ud83d\udcaa","baseLevel":58,"permanentStat":{"type":"HPregenPercent","value":1.5},"bonuses":{"HPregen":0.25,"DamagePercent":4.5,"ArmorPercent":4.0},"acquisition":{"method":"Cosy Cave","requirement":"Reach 45000 score in Cosy Cave"}}]}; // Embedded data for offline use

    async function loadPets() {
      try {
        const response = await fetch('data/pets.json');
        const data = await response.json();
        allPets = data.pets;
      } catch (error) {
        console.warn('Using embedded data:', error);
        if (embeddedPetsData) {
          allPets = embeddedPetsData.pets;
        } else {
          document.getElementById('petsContainer').innerHTML = '<div class="loading">Failed to load pet data</div>';
          return;
        }
      }

      initializeFilters();

      // Check URL for pet parameter
      const urlParams = new URLSearchParams(window.location.search);
      const petId = urlParams.get('pet');

      if (petId) {
        showDetailView(parseInt(petId));
      } else {
        showGridView();
      }
    }

    function initializeFilters() {
      const filterSection = document.getElementById('filterSection');

      // Create filter type tabs
      const filterTypeContainer = document.createElement('div');
      filterTypeContainer.className = 'filter-type-tabs';
      filterTypeContainer.innerHTML = `
        <button class="filter-type-btn active" data-type="stat">By Permanent Stat Bonus</button>
        <button class="filter-type-btn" data-type="equipped">By Equipped Stats</button>
        <button class="filter-type-btn" data-type="acquisition">By Acquisition</button>
        <button class="filter-type-btn" data-type="level">By Level Tier</button>
      `;
      filterSection.appendChild(filterTypeContainer);

      // Create container for filter buttons
      const filterButtonsContainer = document.createElement('div');
      filterButtonsContainer.className = 'filter-buttons-container';
      filterButtonsContainer.id = 'filterButtons';
      filterSection.appendChild(filterButtonsContainer);

      // Initialize stat filters by default
      updateFilterButtons('stat');

      // Event listeners
      filterTypeContainer.addEventListener('click', handleFilterTypeClick);
      filterButtonsContainer.addEventListener('click', handleFilterClick);
    }

    function handleFilterTypeClick(e) {
      if (e.target.classList.contains('filter-type-btn')) {
        // Update active tab
        document.querySelectorAll('.filter-type-btn').forEach(btn =>
          btn.classList.remove('active')
        );
        e.target.classList.add('active');

        // Update filter type and buttons
        currentFilterType = e.target.dataset.type;
        currentFilterValue = 'all';
        selectedEquippedStats = []; // Clear multi-select when switching filter types
        updateFilterButtons(currentFilterType);
      }
    }

    function updateFilterButtons(filterType) {
      const container = document.getElementById('filterButtons');
      container.innerHTML = '';

      // Always add "All Pets" button
      const allBtn = document.createElement('button');
      allBtn.className = 'filter-btn active';
      allBtn.dataset.filter = 'all';
      allBtn.textContent = 'All Pets';
      container.appendChild(allBtn);

      if (filterType === 'stat') {
        // Extract unique stat types
        const statTypes = new Set();
        allPets.forEach(pet => {
          if (pet.permanentStat && pet.permanentStat.type !== 'None') {
            statTypes.add(pet.permanentStat.type);
          }
        });

        Array.from(statTypes).sort().forEach(statType => {
          const btn = document.createElement('button');
          btn.className = 'filter-btn';
          btn.dataset.filter = statType;
          btn.textContent = formatStatTypeName(statType);
          container.appendChild(btn);
        });
      } else if (filterType === 'acquisition') {
        // Extract unique acquisition methods
        const methods = new Set();
        allPets.forEach(pet => {
          if (pet.acquisition && pet.acquisition.method) {
            methods.add(pet.acquisition.method);
          }
        });

        Array.from(methods).sort().forEach(method => {
          const btn = document.createElement('button');
          btn.className = 'filter-btn';
          btn.dataset.filter = method;
          btn.textContent = method;
          container.appendChild(btn);
        });
      } else if (filterType === 'equipped') {
        // Extract unique equipped bonus types (normalized)
        const bonusTypes = new Set();
        allPets.forEach(pet => {
          if (pet.bonuses) {
            Object.keys(pet.bonuses).forEach(bonusType => {
              bonusTypes.add(normalizeStatName(bonusType));
            });
          }
        });

        Array.from(bonusTypes).sort().forEach(bonusType => {
          const btn = document.createElement('button');
          btn.className = 'filter-btn';
          btn.dataset.filter = bonusType;
          btn.textContent = formatStatTypeName(bonusType);
          container.appendChild(btn);
        });
      } else if (filterType === 'level') {
        // Level tiers based on base level
        const tiers = [
          { label: 'Early (1-20)', min: 0, max: 20 },
          { label: 'Mid (21-40)', min: 21, max: 40 },
          { label: 'Late (41-60)', min: 41, max: 60 },
          { label: 'Endgame (61+)', min: 61, max: 999 }
        ];

        tiers.forEach(tier => {
          const btn = document.createElement('button');
          btn.className = 'filter-btn';
          btn.dataset.filter = `level-${tier.min}-${tier.max}`;
          btn.textContent = tier.label;
          container.appendChild(btn);
        });
      }

      displayPetGrid(allPets);
    }

    function normalizeStatName(statType) {
      // Normalize stat names to be consistent
      const normalizations = {
        'CriticalChance': 'CritChance',
        'CriticalDamage': 'CritDamage'
      };
      return normalizations[statType] || statType;
    }

    function formatStatTypeName(statType) {
      // Normalize first, then format
      const normalized = normalizeStatName(statType);
      return normalized
        .replace(/([A-Z])/g, ' $1')
        .replace(/Percent/g, '%')
        .trim();
    }

    function isPercentageStat(statType) {
      // Stats that should display with % suffix
      const percentageStats = [
        'HPPercent', 'DamagePercent', 'ArmorPercent', 'HPregenPercent', 'SpeedPercent',
        'CritChance', 'CriticalChance', 'CritDamage', 'CriticalDamage',
        'Reflect', 'LootChance', 'XpModifier', 'BossDamage',
        'OpenWoundChance', 'Resistance'
      ];
      return percentageStats.includes(statType);
    }

    function handleFilterClick(e) {
      if (e.target.classList.contains('filter-btn')) {
        const filterValue = e.target.dataset.filter;

        // Handle multi-select for equipped stats only
        if (currentFilterType === 'equipped' && filterValue !== 'all') {
          // Toggle selection
          if (e.target.classList.contains('active')) {
            e.target.classList.remove('active');
            selectedEquippedStats = selectedEquippedStats.filter(s => s !== filterValue);
          } else {
            e.target.classList.add('active');
            selectedEquippedStats.push(filterValue);
            // Remove "All Pets" active state when selecting specific stats
            document.querySelector('.filter-btn[data-filter="all"]')?.classList.remove('active');
          }

          // If no stats selected, activate "All Pets"
          if (selectedEquippedStats.length === 0) {
            document.querySelector('.filter-btn[data-filter="all"]')?.classList.add('active');
            currentFilterValue = 'all';
          } else {
            currentFilterValue = selectedEquippedStats[0]; // For compatibility
          }
        } else {
          // Single select mode for other filter types
          document.querySelectorAll('.filter-btn').forEach(btn =>
            btn.classList.remove('active')
          );
          e.target.classList.add('active');
          currentFilterValue = filterValue;
          selectedEquippedStats = []; // Clear multi-select when switching modes
        }

        const filtered = filterPets();
        displayPetGrid(filtered);
      }
    }

    function filterPets() {
      if (currentFilterValue === 'all') {
        return allPets;
      }

      if (currentFilterType === 'stat') {
        return allPets.filter(pet => pet.permanentStat.type === currentFilterValue);
      } else if (currentFilterType === 'equipped') {
        // Multi-select: Check if pet has ALL selected bonuses
        if (selectedEquippedStats.length > 0) {
          return allPets.filter(pet => {
            if (!pet.bonuses) return false;
            // Pet must have ALL selected stats
            return selectedEquippedStats.every(selectedStat => {
              return Object.keys(pet.bonuses).some(bonusType =>
                normalizeStatName(bonusType) === selectedStat
              );
            });
          });
        }
        // Single select fallback
        return allPets.filter(pet => {
          if (!pet.bonuses) return false;
          return Object.keys(pet.bonuses).some(bonusType =>
            normalizeStatName(bonusType) === currentFilterValue
          );
        });
      } else if (currentFilterType === 'acquisition') {
        return allPets.filter(pet => pet.acquisition.method === currentFilterValue);
      } else if (currentFilterType === 'level') {
        const [_, min, max] = currentFilterValue.split('-').map(Number);
        return allPets.filter(pet => {
          const level = pet.baseLevel;
          return level >= min && level <= max;
        });
      }

      return allPets;
    }

    function displayPetGrid(pets) {
      const container = document.getElementById('petsContainer');
      if (pets.length === 0) {
        container.innerHTML = '<div class="loading">No pets found for this filter</div>';
        return;
      }
      container.innerHTML = pets.map(pet => createPetCard(pet)).join('');
    }

    function createPetCard(pet) {
      // Apply level 1 permanent stat modifier (0.2)
      const permanentStatLevel1 = (pet.permanentStat.value * 0.2).toFixed(1);
      const percentSuffix = isPercentageStat(pet.permanentStat.type) ? '%' : '';

      // Build equipped stats (blue badges)
      const bonuses = pet.bonuses || {};
      const bonusesDisplay = Object.entries(bonuses).length > 0
        ? `<div style="display: flex; gap: 0.4rem; flex-wrap: wrap; margin-bottom: 0.5rem;">
             ${Object.entries(bonuses).map(([stat, value]) => {
               const level1Value = (value * 1.2).toFixed(1);
               const sign = value >= 0 ? '+' : '';
               const percentSuffix = isPercentageStat(stat) ? '%' : '';
               return `<span style="background: rgba(6, 182, 212, 0.2); border: 1px solid rgba(6, 182, 212, 0.4); color: var(--accent-cyan); padding: 0.2rem 0.5rem; border-radius: 6px; font-size: 0.75rem; white-space: nowrap;">
                 ${formatStatTypeName(stat)}: ${sign}${level1Value}${percentSuffix}
               </span>`;
             }).join('')}
           </div>`
        : '';

      // Build permanent stat (purple badge)
      const permanentStatDisplay = pet.permanentStat.type !== 'None' && pet.permanentStat.type !== 'XpModifier' || (pet.permanentStat.type === 'XpModifier' && pet.id !== 0)
        ? `<span style="background: rgba(124, 58, 237, 0.2); border: 1px solid rgba(124, 58, 237, 0.4); color: var(--accent-purple); padding: 0.25rem 0.65rem; border-radius: 6px; font-size: 0.8rem; display: inline-block;">
             ${formatStatTypeName(pet.permanentStat.type)}: +${permanentStatLevel1}${percentSuffix}
           </span>`
        : '';

      return `
        <a href="?pet=${pet.id}"
           class="pet-card"
           onclick="navigateToPet(event, ${pet.id})">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
            <div>
              <div class="pet-name">${pet.name}</div>
              <div class="pet-id" style="margin-top: 0.25rem;">ID: ${pet.id} • Lvl ${pet.baseLevel}</div>
            </div>
            ${getPetIcon(pet, 'small')}
          </div>
          ${bonusesDisplay}
          ${permanentStatDisplay}
        </a>
      `;
    }

    function getPetIcon(pet, size = 'small') {
      const imagePath = `images/pets/${pet.id}.png`;
      const sizeClass = size === 'large' ? 'detail-icon' : 'compact-icon';

      return `<div class="${sizeClass}">
        <img src="${imagePath}"
             alt="${pet.name}"
             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
             style="display: block;">
        <span style="display: none; font-size: 2em;">${pet.icon}</span>
      </div>`;
    }

    function showDetailView(petId) {
      const pet = allPets.find(p => p.id === petId);
      if (!pet) {
        showGridView();
        return;
      }

      document.getElementById('gridView').classList.add('hidden');
      document.getElementById('detailView').classList.remove('hidden');

      // Apply level 1 modifiers
      const permanentStatLevel1 = (pet.permanentStat.value * 0.2).toFixed(1);
      const permanentPercentSuffix = isPercentageStat(pet.permanentStat.type) ? '%' : '';

      const statDisplay = pet.permanentStat.type !== 'None'
        ? `<div class="stat-highlight">
             <span class="stat-name">${formatStatTypeName(pet.permanentStat.type)}</span>
             <span class="stat-value">+${permanentStatLevel1}${permanentPercentSuffix}</span>
           </div>`
        : '<p style="color: var(--text-secondary);">No permanent bonus</p>';

      // Build bonuses display with level 1 modifier (1.2)
      const bonuses = pet.bonuses || {};
      const bonusesEntries = Object.entries(bonuses);
      const bonusesDisplay = bonusesEntries.length > 0
        ? `<div class="stats-grid">
             ${bonusesEntries.map(([stat, value]) => {
               const level1Value = (value * 1.2).toFixed(1);
               const sign = value >= 0 ? '+' : '';
               const percentSuffix = isPercentageStat(stat) ? '%' : '';
               return `<div class="stat-item">
                 <span class="label">${formatStatTypeName(stat)}</span>
                 <span class="value">${sign}${level1Value}${percentSuffix}</span>
               </div>`;
             }).join('')}
           </div>`
        : '<p style="color: var(--text-secondary);">No bonuses</p>';

      document.getElementById('detailView').innerHTML = `
        <button class="back-btn" onclick="showGridView()">
          ← Back to All Pets
        </button>

        <div class="detail-card">
          <div class="detail-header">
            ${getPetIcon(pet, 'large')}
            <div class="detail-title-group">
              <h1 class="detail-name">${pet.name}</h1>
              <p class="detail-id">Pet ID: ${pet.id} • Base Level: ${pet.baseLevel}</p>
            </div>
          </div>

          <div class="stats-section">
            <h3>Permanent Bonus (Level 1)</h3>
            ${statDisplay}
          </div>

          <div class="stats-section">
            <h3>Bonuses at Level 1</h3>
            ${bonusesDisplay}
          </div>

          <div class="stats-section">
            <h3>How to Obtain</h3>
            <div class="acquisition-box">
              <span class="method-badge">${pet.acquisition.method}</span>
              <p>${pet.acquisition.requirement}</p>
            </div>
          </div>
        </div>
      `;

      // Update URL without page reload
      history.pushState({ petId }, '', `?pet=${petId}`);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function showGridView() {
      document.getElementById('gridView').classList.remove('hidden');
      document.getElementById('detailView').classList.add('hidden');

      const filtered = filterPets();
      displayPetGrid(filtered);

      // Update URL
      history.pushState({}, '', 'pets-viewer.html');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function navigateToPet(event, petId) {
      event.preventDefault();
      showDetailView(petId);
    }

    // Handle browser back/forward
    window.addEventListener('popstate', (event) => {
      const urlParams = new URLSearchParams(window.location.search);
      const petId = urlParams.get('pet');

      if (petId) {
        showDetailView(parseInt(petId));
      } else {
        showGridView();
      }
    });

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', loadPets);
  </script>
</body>
</html>
