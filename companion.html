<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title id="page-title">Companion Guide â€“ Idle Adventure | Stats, Skills & Strategies</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Complete Idle Adventure companion guide: Learn about companion stats, skills, leveling, and optimal strategies. Maximize your companion's effectiveness in combat.">
  <meta name="keywords" content="Idle Adventure companions, companion guide, companion skills, companion stats, companion strategies, pet system, companion leveling">
  <meta name="author" content="PacmenCo">
  <meta name="theme-color" content="#0a0e1a">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://pacmenco.github.io/companion.html">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://pacmenco.github.io/companion.html">
  <meta property="og:title" content="Idle Adventure Companion Guide">
  <meta property="og:description" content="Master companions in Idle Adventure: stats, skills, leveling strategies, and combat optimization. Complete companion system guide.">
  <meta property="og:site_name" content="Idle Adventure Guide">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="https://pacmenco.github.io/companion.html">
  <meta name="twitter:title" content="Idle Adventure Companion Guide">
  <meta name="twitter:description" content="Complete companion guide: stats, skills, leveling, and strategies for Idle Adventure.">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Space+Grotesk:wght@400;500;600;700&display=swap"
    rel="stylesheet">

  <!-- Shared Navigation Component -->
  <script src="nav.js"></script>

  <!-- Shared Styles -->
  <link rel="stylesheet" href="companion-styles.css">
</head>

<body>
  <!-- Navigation loaded from nav.js -->

  <div class="container">
    <!-- Hero Section -->
    <div class="hero-section" id="hero-section">
      <img id="companion-image" class="companion-image" alt="Companion Image" />
      <h1 class="companion-title" id="companion-title"></h1>
      <p class="companion-subtitle" id="companion-subtitle"></p>
      <div class="unlock-badge" id="unlock-badge"></div>
    </div>

    <!-- Base Statistics Section -->
    <div class="content-section" id="base-stats-section" style="display: none;">
      <h2>ðŸ“Š Base Statistics</h2>
      <div class="stats-grid" id="base-stats-grid"></div>
      <p id="stats-description" style="color: var(--text-secondary); line-height: 1.8; margin-top: 1.5rem;"></p>
    </div>

    <!-- Dynamic Content Sections -->
    <div id="content-sections"></div>
  </div>

  <!-- Load companion data -->
  <script src="companions-data.js"></script>
  <script>
    // Get companion ID from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const companionId = urlParams.get('id') || 'jindo';

    // Load companion data from companionsData object
    const companion = companionsData[companionId];

    if (!companion) {
      document.querySelector('.container').innerHTML = `
        <div class="content-section">
          <h2>Companion Not Found</h2>
          <p>The companion "${companionId}" could not be found.</p>
          <p><a href="companions.html" style="color: var(--accent-cyan);">Return to Companions List</a></p>
        </div>
      `;
    } else {
      renderCompanion(companion);
    }

    function renderCompanion(companion) {
      // Update page title
      document.getElementById('page-title').textContent = `${companion.name} â€“ Idle Adventure`;

      // Apply theme colors to hero section
      const heroSection = document.getElementById('hero-section');
      heroSection.style.background = companion.theme.heroBg;
      heroSection.style.borderColor = companion.theme.heroBorder;

      // Populate hero section
      // Set companion image
      const imageEl = document.getElementById('companion-image');
      // Capitalize first letter for image filename
      const imageFileName = companionId.charAt(0).toUpperCase() + companionId.slice(1);
      imageEl.src = `images/companion/${imageFileName}.png`;
      imageEl.alt = companion.name;
      // Hide image if it fails to load
      imageEl.onerror = function() {
        this.style.display = 'none';
      };
      imageEl.onload = function() {
        this.style.display = 'block';
      };

      const titleElement = document.getElementById('companion-title');
      titleElement.textContent = companion.name;
      titleElement.style.background = companion.theme.gradient;
      titleElement.style.webkitBackgroundClip = 'text';
      titleElement.style.backgroundClip = 'text';

      document.getElementById('companion-subtitle').textContent = companion.subtitle;

      const badgeElement = document.getElementById('unlock-badge');
      badgeElement.textContent = `Special: Unlocks at Lv. ${companion.unlockLevel} | Cost: ${companion.cost} Gems`;
      badgeElement.style.background = companion.theme.abilityBg;
      badgeElement.style.borderColor = companion.theme.abilityBorder;

      // Populate base stats
      const baseStatsSection = document.getElementById('base-stats-section');
      baseStatsSection.style.display = 'block';

      const statsGrid = document.getElementById('base-stats-grid');
      const stats = companion.baseStats;
      statsGrid.innerHTML = `
        <div class="stat-card">
          <div class="stat-label">STR</div>
          <div class="stat-value">${stats.str}</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">DEX</div>
          <div class="stat-value">${stats.dex}</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">CON</div>
          <div class="stat-value">${stats.con}</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">LUCK</div>
          <div class="stat-value">${stats.luck}</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">SPECIAL</div>
          <div class="stat-value">${stats.special}</div>
        </div>
      `;

      document.getElementById('stats-description').textContent = companion.statsDescription;

      // Render content sections in order:
      // 1. Special Ability
      // 2. How to Activate
      // 3. Base Statistics (inserted here)
      // 4. Stat Scaling
      // 5. Combat Strategy
      // 6. Recommended Builds
      const contentContainer = document.getElementById('content-sections');

      companion.sections.forEach((section, index) => {
        contentContainer.appendChild(renderSection(section, companion.theme));

        // Insert Base Statistics after section index 1 (after "How to Activate")
        if (index === 1) {
          contentContainer.appendChild(baseStatsSection);
        }
      });
    }

    function renderSection(section, theme) {
      const sectionDiv = document.createElement('div');
      sectionDiv.className = 'content-section';

      // Add section title
      const title = document.createElement('h2');
      title.textContent = section.title;
      sectionDiv.appendChild(title);

      // Render content blocks
      section.content.forEach(block => {
        sectionDiv.appendChild(renderContentBlock(block, theme));
      });

      return sectionDiv;
    }

    function renderContentBlock(block, theme) {
      switch (block.type) {
        case 'ability-box':
          return renderAbilityBox(block, theme);
        case 'heading':
          return renderHeading(block);
        case 'paragraph':
          return renderParagraph(block);
        case 'list':
          return renderList(block);
        case 'stats-grid':
          return renderStatsGrid(block);
        case 'formula-box':
          return renderFormulaBox(block);
        case 'warning-box':
          return renderWarningBox(block);
        case 'info-box':
          return renderInfoBox(block, theme);
        case 'build-card':
          return renderBuildCard(block, theme);
        default:
          return document.createElement('div');
      }
    }

    function renderAbilityBox(block, theme) {
      const box = document.createElement('div');
      box.className = 'ability-box';
      box.style.background = theme.abilityBg;
      box.style.borderLeftColor = theme.abilityBorder;

      const name = document.createElement('div');
      name.className = 'ability-name';
      name.style.color = theme.abilityColor;
      name.textContent = block.name;
      box.appendChild(name);

      if (block.cost) {
        const cost = document.createElement('div');
        cost.className = 'ability-cost';
        cost.textContent = block.cost;
        box.appendChild(cost);
      }

      const description = document.createElement('p');
      description.innerHTML = block.description;
      box.appendChild(description);

      return box;
    }

    function renderHeading(block) {
      const heading = document.createElement(`h${block.level}`);
      if (block.level === 3) {
        heading.style.marginTop = '1.5rem';
      }
      heading.innerHTML = block.text;
      return heading;
    }

    function renderParagraph(block) {
      const p = document.createElement('p');
      p.innerHTML = block.text;
      return p;
    }

    function renderList(block) {
      const ul = document.createElement('ul');
      if (block.className) {
        ul.className = block.className;
      }
      block.items.forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = item;
        ul.appendChild(li);
      });
      return ul;
    }

    function renderStatsGrid(block) {
      const grid = document.createElement('div');
      grid.className = 'stats-grid';

      block.stats.forEach(stat => {
        const statBox = document.createElement('div');
        statBox.className = 'stat-box';

        const label = document.createElement('div');
        label.className = 'stat-label';
        label.textContent = stat.label;
        statBox.appendChild(label);

        const value = document.createElement('div');
        value.className = 'stat-value';
        value.textContent = stat.value;
        statBox.appendChild(value);

        const sublabel = document.createElement('div');
        sublabel.className = 'stat-label';
        sublabel.textContent = stat.sublabel;
        statBox.appendChild(sublabel);

        grid.appendChild(statBox);
      });

      return grid;
    }

    function renderFormulaBox(block) {
      const box = document.createElement('div');
      box.className = 'formula-box';
      box.innerHTML = block.formula;
      return box;
    }

    function renderWarningBox(block) {
      const box = document.createElement('div');
      box.className = 'warning-box';
      box.innerHTML = block.text;
      return box;
    }

    function renderInfoBox(block, theme) {
      const box = document.createElement('div');
      box.className = 'info-box';
      box.innerHTML = block.text;
      return box;
    }

    function renderBuildCard(block, theme) {
      const card = document.createElement('div');
      card.className = 'build-card';
      card.style.background = theme.abilityBg;
      card.style.borderColor = theme.abilityBorder;

      const name = document.createElement('div');
      name.className = 'build-name';
      name.style.color = theme.abilityColor;
      name.textContent = block.name;
      card.appendChild(name);

      const description = document.createElement('div');
      description.className = 'build-description';
      description.textContent = block.description;
      card.appendChild(description);

      const stats = document.createElement('div');
      stats.className = 'build-stats';
      stats.textContent = `Priority: ${block.priority}`;
      card.appendChild(stats);

      return card;
    }
  </script>
</body>

</html>
